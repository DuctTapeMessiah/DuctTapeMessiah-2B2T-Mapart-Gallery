<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>DuctTapeMessiah — 2B2T Gallery</title>
<link rel="canonical" href="https://ducttapemessiah.art"/>

<style>
/* ================= BASE ================= */
:root{
  --bg:#0b0b0d;
  --panel:#0f1113;
  --muted:#94a3b8;
  --accent:#b6c7d6;
  --glass:rgba(255,255,255,.035);
  --overlay-glass:rgba(15,17,19,.9);
  --letterbox:rgba(0,0,0,.75);
  --shadow:0 10px 30px rgba(0,0,0,.65);
  font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial
}
html,body{margin:0;background:linear-gradient(180deg,var(--bg),#050506 120%);color:#e6eef6}

/* ================= LAYOUT ================= */
.wrap{max-width:1200px;margin:28px auto;padding:18px}
header{display:flex;gap:18px;margin-bottom:18px}
.logo{width:72px;height:72px;border-radius:12px;overflow:hidden}
.logo img{width:100%;height:100%;object-fit:cover}

/* ================= GRID ================= */
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(250px,1fr));
  gap:16px;
  margin-top:16px;
  padding-top:100px;
}
.card{
  background:var(--glass);
  border-radius:12px;
  box-shadow:var(--shadow);
  overflow:hidden;
}
.thumb-wrapper{aspect-ratio:1/1;background:#000}
.thumb{
  width:100%;height:100%;
  object-fit:contain;
  image-rendering:pixelated;
  cursor:pointer;
}
.meta{
  padding:8px;
  text-align:center;
}
.maps-tag{
  display:inline-block;
  font-size:12px;
  padding:4px 9px;
  border-radius:999px;
  background:rgba(182,199,214,.18);
  color:var(--accent);
  font-weight:700;
}

/* ================= MODAL ================= */
.modal{
  position:fixed;
  inset:0;
  background:rgba(3,6,10,.95);
  display:flex;
  justify-content:center;
  opacity:0;
  pointer-events:none;
  transition:.25s;
  z-index:50;
}
.modal.open{opacity:1;pointer-events:auto}
.modal-viewport{
  flex:1;
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
}
.modal-img{
  image-rendering:pixelated;
  transition:transform .15s;
}

/* ================= OVERLAY ================= */
.modal-overlay{
  position:absolute;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  background:var(--overlay-glass);
  padding:14px 20px;
  border-radius:16px;
  max-width:90%;
  text-align:center;
  box-shadow:0 8px 30px rgba(0,0,0,.6);
}
.details{
  display:none;
  margin-top:10px;
  font-size:14px;
  line-height:1.5;
}
.details.open{display:block}
.details-btn{
  margin-top:8px;
  background:var(--panel);
  border:none;
  border-radius:10px;
  padding:6px 12px;
  cursor:pointer;
}

/* ================= NAV ================= */
.nav-arrow{
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  width:44px;height:70px;
  background:rgba(0,0,0,.5);
  border-radius:10px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:30px;
  cursor:pointer;
  opacity:0;
  transition:opacity .3s;
}
.nav-arrow.show{opacity:.75}
.nav-arrow.prev{left:20px}
.nav-arrow.next{right:20px}

/* ================= CONTROLS ================= */
.modal-controls{
  position:absolute;
  bottom:20px;
  right:20px;
  display:flex;
  gap:8px;
}
.modal-controls button{
  padding:6px 10px;
  background:var(--panel);
  border:none;
  border-radius:10px;
  cursor:pointer;
}

/* ================= MOBILE ================= */
@media(max-width:768px){
  .modal-controls{flex-direction:row}
}
</style>
</head>

<body>

<div class="wrap">
<header>
  <div class="logo"><img src="images/DTM.png"></div>
  <div>
    <div style="font-size:26px;font-weight:800">DuctTapeMessiah</div>
    <div style="color:var(--muted)">2B2T Gallery</div>
  </div>
</header>

<div id="gallery" class="grid"></div>
</div>

<div id="modal" class="modal">
  <div class="modal-viewport" id="modalViewport">
    <img id="modalImg" class="modal-img">
    <div class="nav-arrow prev" id="prevBtn">‹</div>
    <div class="nav-arrow next" id="nextBtn">›</div>
  </div>

  <div class="modal-overlay">
    <div id="overlayTitle"></div>
    <div id="overlayMeta"></div>
    <button class="details-btn" id="detailsBtn">Details</button>
    <div class="details" id="detailsBox"></div>
  </div>

  <div class="modal-controls">
    <button id="fitBtn">Fit</button>
  </div>
</div>

<script>
let DATA=[],items=[],idx=0,scale=1,x=0,y=0;
const modal=document.getElementById('modal');
const img=document.getElementById('modalImg');
const prev=document.getElementById('prevBtn');
const next=document.getElementById('nextBtn');
const overlayTitle=document.getElementById('overlayTitle');
const overlayMeta=document.getElementById('overlayMeta');
const detailsBox=document.getElementById('detailsBox');

fetch('maps.json').then(r=>r.json()).then(j=>{
  DATA=j;
  render();
});

function render(){
  const g=document.getElementById('gallery');
  g.innerHTML='';
  DATA
    .sort((a,b)=>Number(b.total||0)-Number(a.total||0)) // FIXED SORT
    .forEach((m,i)=>{
      const c=document.createElement('div');
      c.className='card';
      c.innerHTML=`
        <div class="thumb-wrapper">
          <img class="thumb" src="${m.thumb||m.image}">
        </div>
        <div class="meta">
          <div>${m.title||''}</div>
          <div class="maps-tag">${m.total||''} maps</div>
        </div>`;
      c.onclick=()=>open(i);
      g.appendChild(c);
    });
}

function open(i){
  idx=i;
  const m=DATA[i];
  modal.classList.add('open');
  img.src=m.image;
  overlayTitle.innerHTML=`<strong>${m.title||''}</strong>`;
  overlayMeta.innerHTML=m.date||'';
  detailsBox.innerHTML=(m.description||'')+(m.artistCredit?`<div>Credit: ${m.artistCredit}</div>`:'');
  fit();
  showArrows();
}

function fit(){
  const vp=document.getElementById('modalViewport');
  scale=Math.min(
    vp.clientWidth/img.naturalWidth,
    vp.clientHeight/img.naturalHeight
  );
  x=y=0;
  update();
}
function update(){
  img.style.transform=`translate(${x}px,${y}px) scale(${scale})`;
}
function showArrows(){
  prev.classList.add('show');
  next.classList.add('show');
  setTimeout(()=>{
    prev.classList.remove('show');
    next.classList.remove('show');
  },3000);
}

document.getElementById('fitBtn').onclick=fit;
document.getElementById('detailsBtn').onclick=()=>detailsBox.classList.toggle('open');
prev.onclick=()=>idx>0&&open(idx-1);
next.onclick=()=>idx<DATA.length-1&&open(idx+1);
modal.onclick=e=>e.target===modal&&modal.classList.remove('open');
</script>

</body>
</html>
